<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>practice</title>
    </head>
    <body>
        <input type="text" class="text">
        <button class="btn">追加</button>
       <ul class="list"></ul>
       <p class="count"></p>
    </body>
    <script>
        const text = document.querySelector(".text");
        const btn = document.querySelector(".btn");
        const list = document.querySelector(".list");
        const count = document.querySelector(".count");
        text.addEventListener("keydown",function(e){
            if(e.key === "Enter"){
            addTask();
        }
        });
        function uppdateCount(){
            const items = document.querySelectorAll("li");
            let num = 0;
             items.forEach(function(item){
                if(!item.querySelector("span").classList.contains("done")){
                    num++;
                }
            count.textContent = "残りタスク" + num;
                
             }); 

        }
       
        function addTask(){
            if(text.value.trim() === "")return;
            const li = document.createElement("li");
            const span = document.createElement("span");
            const delete_btn = document.createElement("button");
            const comp_btn = document.createElement("button");
            delete_btn.classList.add("delete");
            comp_btn.classList.add("complete");
            span.textContent = text.value.toUpperCase();
            delete_btn.textContent = "削除";
            comp_btn.textContent = "完了";
            li.appendChild(span);
            li.appendChild(comp_btn);
            li.appendChild(delete_btn);
            list.appendChild(li);
            text.value="";
            uppdateCount();

        }
        btn.addEventListener("click",addTask);
        list.addEventListener("click",function(e){
            if(e.target.tagName === "SPAN"){
                if(e.target.textContent === e.target.textContent.toUpperCase()){
                    e.target.textContent = e.target.textContent.toLowerCase();
                }else{
                    e.target.textContent = e.target.textContent.toUpperCase()
                }
            }

            if(e.target.classList.contains("complete")){
                const span = e.target.parentElement.querySelector("span");
               if(span.classList.toggle("done")) {
                e.target.textContent = "未完了";
               }else{
                e.target.textContent = "完了";
               }
               uppdateCount();
            }
            if(e.target.classList.contains("delete")){
                e.target.parentElement.remove();
                uppdateCount();
            }
        });
    </script>
    <style>
        .done{
            text-decoration: line-through;
        }
    </style>
</html>